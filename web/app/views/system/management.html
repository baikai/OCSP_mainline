<script type="text/ng-template" id="stackedModal.html">
  <div class="modal-header">
    <h3 class="modal-title">{{'ocsp_web_system_manage_003' | translate}}</h3>
  </div>
  <div class="modal-body">
    <div class="form-group">
      <label>{{'ocsp_web_common_011' | translate}}*</label>
      <input type="text" name="name" class="form-control" ng-model="newDatasource.name" required>
    </div>
    <div class="form-group">
      <label>{{'ocsp_web_common_031' | translate}}*</label>
      <ui-select ng-model="newDatasource.type" ng-required="true">
        <ui-select-match>
          <span ng-bind="$select.selected"></span>
        </ui-select-match>
        <ui-select-choices
          repeat="item in (['kafka','codis'] | filter: $select.search) track by item">
          <span ng-bind="item"></span>
        </ui-select-choices>
      </ui-select>
    </div>
    <div class="form-group" ng-if="newDatasource.type === 'kafka'">
      <label>zookeeper.connect</label>
      <input type="text" name="name" class="form-control" ng-model="newDatasource.zk" required>
    </div>
    <div class="form-group" ng-if="newDatasource.type === 'kafka'">
      <label>metadata.broker.list</label>
      <input type="text" name="name" class="form-control" ng-model="newDatasource.blist" required>
    </div>
    <div class="form-group" ng-if="newDatasource.type === 'codis'">
      <label>zk</label>
      <input type="text" name="name" class="form-control" ng-model="newDatasource.zk" required>
    </div>
    <div class="form-group" ng-if="newDatasource.type === 'codis'">
      <label>zkpath</label>
      <input type="text" name="name" class="form-control" ng-model="newDatasource.zkpath" required>
    </div>
    <div class="form-group">
      <label>{{'ocsp_web_common_012' | translate}}</label>
      <textarea ng-model="newDatasource.description" class="form-control" rows="6"></textarea>
    </div>
    <div class="form-group">
      <button type="button" class="btn btn-primary" ng-click="saveDatasource()">{{'ocsp_web_common_009' | translate}}</button>
    </div>
  </div>
</script>
<div class="row">
  <div class="col-md-2 well">
    <div class="list-group">
      <div class="list-group-item">
        <button class="wizard-button btn btn-default btn-block" ng-click="openSparkModal()">{{'ocsp_web_system_manage_003' | translate}}</button>
      </div>
      <div class="list-group-item">
        {{'ocsp_web_system_manage_001' | translate}}
      </div>
    </div>
  </div>
  <div class="col-md-10 main">
    <div class="panel panel-oc">
      <div class="panel-heading">
        {{'ocsp_web_system_manage_001' | translate}}
      </div>
      <div class="panel-body">
        <uib-accordion>
          <div uib-accordion-group class="panel-default" ng-init="isOpen = true" is-open="isOpen">
            <uib-accordion-heading>
              <i class="glyphicon" ng-class="{'glyphicon-chevron-down': isOpen, 'glyphicon-chevron-right': !isOpen}"></i>
              &nbsp; {{'ocsp_web_common_013' | translate}}
            </uib-accordion-heading>
            <div ng-repeat="property in prop" class="form-group">
              <div class="row">
                <div class="col-md-2">
                  <label>{{property.name}}</label>
                </div>
                <div class="col-md-8">
                  <input ng-model="property.value" class="form-control" popover-trigger="'mouseenter'"
                         popover-placement="right"
                         uib-popover="Description: {{property.description}}" popover-title="{{property.name}}">
                </div>
              </div>
            </div>
          </div>
        </uib-accordion>
        <uib-accordion ng-repeat="data in datasource">
          <div uib-accordion-group class="panel-default" popover-trigger="'mouseenter'" ng-init="data.isOpen = true" is-open="data.isOpen"
               popover-placement="right" popover-title="{{data.name}}" uib-popover="Description: {{data.description}}">
            <uib-accordion-heading>
              <i class="glyphicon" ng-class="{'glyphicon-chevron-down': data.isOpen, 'glyphicon-chevron-right': !status.isOpen}"></i>
              &nbsp;{{data.name}}
              <span ng-if="data.type === 'kafka'" class="label label-danger">Kafka</span>
              <span ng-if="data.type === 'codis'" class="label label-success">Codis</span>
              <a class="pull-right" ng-if="data.status === 2"
                 ng-click="$event.stopPropagation();$event.preventDefault();remove($index)">
                <i class="glyphicon glyphicon-remove"></i>
              </a>
            </uib-accordion-heading>
            <div ng-repeat="item in data.props track by $index" class="form-group">
              <div class="row" ng-show="data.type === 'kafka' || (data.type === 'codis' && (item.pname === 'zk' || item.pname === 'zkpath'))">
                <div class="col-md-2">
                  <label>{{item.pname}}</label>
                </div>
                <div class="col-md-8">
                  <input class="form-control" ng-model="item.pvalue">
                </div>
              </div>
            </div>
          </div>
        </uib-accordion>
        <button type="button" class="btn btn-primary" ng-click="save()">{{'ocsp_web_common_009' | translate}}</button>
      </div>
    </div>
  </div>
</div>
